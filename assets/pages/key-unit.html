<!DOCTYPE html>
<html>

<head>
	<meta chartset='utf-8'>
	<title>重点单位管理</title>
	<link rel="stylesheet" type="text/css" href="../css/reset.css">
	<link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="../css/zxx.lib.css">
	<link rel="stylesheet" type="text/css" href="../css/element.css">
	<link rel="stylesheet" type="text/css" href="../css/app.css">
	<link rel="stylesheet" type="text/css" href="../css/formal.css">
</head>

<body class="fw f14">
	<div id="app">
		<el-container>
			<div class="header-box navbar">
				<div class="container">
					<div class="navbar-header">
						<button class="navbar-toggle collapsed" id="oscar-nav-btn" type="button" data-toggle="collapse" data-target="#bs-navbar"
						aria-controls="bs-navbar" aria-expanded="false">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
						<a href="../" class="navbar-brand">
							<div class="logo2">
								<!-- 运营拍档 -->
							</div>
						</a>
					</div>
					<!-- /navbar-header -->
					<nav class="navbar-collapse collapse" id="bs-nav">
						<ul class="nav navbar-nav navbar-right">
							<li>
								<a class="fix" style="width:44px;" href="/assets/pages/test02.html">
									<img src="../images/shishizhanshi.png">
								</a>
							</li>
							<li>
								<a class="glyphicon glyphicon-cog" href="javascript:;"></a>
							</li>
							<li>
								<a class="f12" href="javascript:;">
									<span>oscar@outlook.com</span>
									<span class="glyphicon glyphicon-triangle-top oscar-arrow frame-duration"></span>
									<div class="dada abs ovh">
										<div class="dada-item">
											<span class="glyphicon glyphicon-user"></span>
											<span class="ml5">个人中心</span>
										</div>
										<div class="dada-item">
											<span class="glyphicon glyphicon-off"></span>
											<span class="ml5">退出</span>
										</div>
									</div>
									<!-- /dada -->
								</a>
							</li>
						</ul>
					</nav>
					<div class="dada2 abs ovh f12">
						<div class="dada-item">
							<span class="glyphicon glyphicon-user"></span>
							<span class="ml5">个人中心</span>
						</div>
						<div class="dada-item">
							<span class="glyphicon glyphicon-off"></span>
							<span class="ml5">退出</span>
						</div>
					</div>
					<!-- /dada -->
				</div>
				<!-- /container -->
			</div>
			<!-- /header-box -->

			<div class="left-sidebar">
				<a id="menu-toggle-btn" class="abs db el-icon-arrow-left menu-toggle-btn f12 tc" href="javascript:;"></a>
				<div id="menu-box">
					<big-tree default-active="2-1"></big-tree>
				</div>
			</div>
			<!-- /left-sidebar -->

			<div class="main-box">
				<div class="main-container">
					<div id="tableView">
						<el-row> 
							<el-form  label-width="75px" :inline="true" class="el-form demo-form-inline">
								<el-row>
									<el-col :span="10">
                                        <el-form-item label="单位名称">  
                                            <el-input size="small" v-model="searchForm.DWMC" placeholder="单位名称" style="width: 324px"></el-input>  
                                        </el-form-item>
									</el-col>
									<el-col :span="10">
                                        <el-form-item label="单位等级">  
                                            <el-select size="small" v-model="searchForm.DWDJ" placeholder="单位等级" style="width: 324px">  
                                                <el-option label="省部级" value="省部级"></el-option>  
                                                <el-option label="市厅级" value="市厅级"></el-option>
                                                <el-option label="区局级" value="区局级"></el-option>  
                                            </el-select>  
                                        </el-form-item>
									</el-col>
                                </el-row>
                                <el-row>
									<el-col :span="10" class="single-search-left">
                                        <el-form-item label="单位性质">  
                                            <el-select size="small" v-model="searchForm.DWXZ" placeholder="单位性质" style="width: 324px">  
                                                <el-option label="司法" value="司法"></el-option>
                                                <el-option label="行政" value="行政"></el-option>    
                                                <el-option label="城市管理" value="城市管理"></el-option>
                                                <el-option label="民事" value="民事"></el-option>
                                            </el-select>  
                                        </el-form-item>
									</el-col>
									<el-col :span="10">
                                        <el-form-item label="行政区域">  
                                            <el-select size="small" v-model="searchForm.XZQY" placeholder="行政区域" style="width: 324px">  
                                                <el-option label="辽宁省" value="辽宁省"></el-option>  
                                                <el-option label="山东省" value="山东省"></el-option>
                                                <el-option label="河北省" value="河北省"></el-option>  
                                            </el-select>  
                                        </el-form-item>
									</el-col>
								</el-row>  
								<div>
									<el-form>
										<el-col :span="12" style="text-align: left">
											<el-form-item align="left">  
												<!--<el-button type="primary" icon="edit" size="small" @click="editClick">编辑</el-button>-->  
												<!-- <el-button type="danger" icon="delete" size="small" @click="removeSelection">删除</el-button>   -->
											</el-form-item>
										</el-col>
										<el-col :span="12"></el-col>
										<el-col :span="12" style="text-align: right">
											<el-form-item>  
												<el-button type="primary" icon="search" size="small" @click="searchClick">查询</el-button>  
												<!-- <el-button type="success" icon="plus" size="small" @click="addClick">新增</el-button>   -->
											</el-form-item>
										</el-col>
									</el-form>
								</div>
							</el-form>
						</el-row> 


						
						<div class="table_container">
						<el-table
								border
								id="table"
								:data="tableData.slice((currentPage-1)*pageSize,currentPage*pageSize)"
								v-loading.body="loading"  
								@selection-change="selectionChange"  
								style="width: 100%;"
								:height="tableheight"
								>
			
							<el-table-column  
							type="selection"  
							min-width="5%">  
							</el-table-column>
							<el-table-column 
								type="index" 
								label="序号"
								width="65"
								align="center">
							</el-table-column>
							<el-table-column  
								prop="DWMC"  
								label="单位名称"  
								min-width="18%"
                                align="center">
                                <template slot-scope="scope">  
                                    <el-button @click="informClick(scope.row)" type="text">{{scope.row.DWMC}}</el-button>
                                </template>  
							</el-table-column>  
							<el-table-column  
								prop="DWDJ"  
								label="单位等级"  
								min-width="12%"
								align="center">  
							</el-table-column>  
							<el-table-column  
								prop="DWXZ"  
								label="单位性质" 
								min-width="12%"
								align="center">  
							</el-table-column> 
							<el-table-column  
								prop="XZQY"  
								label="行政区域"  
								min-width="12%"
								align="center">  
							</el-table-column>  
							<el-table-column  
								prop="DWDZ"  
								label="单位地址"  
								min-width="14%"
								align="center">  
							</el-table-column>  
							<el-table-column  
								prop="ZDMJ"  
								label="占地面积"  
								min-width="11%"
								align="center">  
                            </el-table-column>
                            <el-table-column  
								prop="XFGXJGID"  
								label="消防管辖机构"  
								min-width="22%"
								align="center">  
							</el-table-column>
						</el-table>
						
								<!---->
								<!---->
						


						<!--列表底部工具条和分页符-->  
						<el-row type="flex" justify="end">   
								<el-col :span="18" >  
									<el-pagination  
											style="float: right"  
											@size-change="pageSizeChange"  
											@current-change="currentPageChange"  
											:current-page="currentPage"  
											:page-sizes="[10, 20, 30, 50]"  
											:page-size="pageSize"  
											layout="total, sizes, prev, pager, next, jumper"  
											:total=parseInt(total)>  
									</el-pagination>  
								</el-col>  
							</el-row> 
						</div>
							<!--新建界面-->  
							<el-dialog title="新建用户" :visible.sync="addFormVisible" @close="closeDialog(addForm)" :close-on-click-modal="false">  
								<el-form :model="addForm" label-width="80px" :rules="addFormRules" ref="addForm">
									<el-row>
										<el-col :span="8">            
											<el-form-item label="权限名称" prop="permissionname">  
											<el-input v-model="addForm.permissionname" auto-complete="off" placeholder="权限名称" style="width:180px"></el-input>  
											</el-form-item>
										</el-col>
										<el-col :span="4">&nbsp;</el-col>
										<el-col :span="8">            
											<el-form-item label="权限描述" prop="permissioninfo">  
											<el-input v-model="addForm.permissioninfo" auto-complete="off" placeholder="权限描述" style="width:180px"></el-input>  
											</el-form-item>
										</el-col>
									</el-row> 
									<el-row>
										<el-col :span="8">
                                            <el-form-item label="创建人" prop="create_name">  
                                                <el-input v-model="addForm.create_name" auto-complete="off" placeholder="创建人" style="width:180px"></el-input>  
                                            </el-form-item>
										</el-col>
										<el-col :span="4">&nbsp;</el-col>
										<el-col :span="8">
											<el-form-item label="创建时间">  
												<el-date-picker type="date" placeholder="选择日期" @change="createdateChange" format="yyyy-MM-dd"
												value-format="yyyy-MM-dd" v-model="addForm.create_time" style="width:180px"></el-date-picker>  
                                            </el-form-item>
										</el-col>
									</el-row>
									<el-row>
										<el-col :span="8">            
											<el-form-item label="修改人" prop="alter_name">  
											<el-input v-model="addForm.alter_name" auto-complete="off" placeholder="修改人" style="width:180px"></el-input>  
											</el-form-item>
										</el-col>
										<el-col :span="4">&nbsp;</el-col>
										<el-col :span="8">            
											<el-form-item label="修改时间" prop="alter_time">  
                                                <el-date-picker type="date" placeholder="选择日期" @change="alterdateChange" format="yyyy-MM-dd"
												value-format="yyyy-MM-dd" v-model="addForm.alter_time" style="width:180px"></el-date-picker>
											</el-form-item>
										</el-col>
									</el-row>   
								</el-form>  
								<div slot="footer" class="dialog-footer">  
									<el-button @click.native="closeDialog(addForm)">取消</el-button>  
									<el-button type="primary" @click.native="addSubmit(addForm)">提交</el-button>  
								</div>  
							</el-dialog> 

							<!--编辑界面-->  
							<el-dialog title="编辑" :visible.sync="editFormVisible" :close-on-click-modal="false">  
							<el-form :model="editForm" label-width="80px" :rules="editFormRules" ref="editForm">
								<el-row>
                                    <el-col :span="8">            
                                        <el-form-item label="权限名称" prop="permissionname">  
                                        <el-input v-model="editForm.permissionname" auto-complete="off" placeholder="权限名称" style="width:180px"></el-input>  
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span="4">&nbsp;</el-col>
                                    <el-col :span="8">            
                                        <el-form-item label="权限描述" prop="permissioninfo">  
                                        <el-input v-model="editForm.permissioninfo" auto-complete="off" placeholder="权限描述" style="width:180px"></el-input>  
                                        </el-form-item>
                                    </el-col>
                                </el-row> 
                                <el-row>
                                    <el-col :span="8">
                                        <el-form-item label="创建人" prop="create_name">  
                                            <el-input v-model="editForm.create_name" auto-complete="off" placeholder="创建人" style="width:180px"></el-input>  
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span="4">&nbsp;</el-col>
                                    <el-col :span="8">
                                        <el-form-item label="创建时间">  
                                            <el-date-picker type="date" placeholder="选择日期" @change="createdateChange" format="yyyy-MM-dd"
                                            value-format="yyyy-MM-dd" v-model="editForm.create_time" style="width:180px"></el-date-picker>  
                                        </el-form-item>
                                    </el-col>
                                </el-row>
                                <el-row>
                                    <el-col :span="8">            
                                        <el-form-item label="修改人" prop="alter_name">  
                                        <el-input v-model="editForm.alter_name" auto-complete="off" placeholder="修改人" style="width:180px"></el-input>  
                                        </el-form-item>
                                    </el-col>
                                    <el-col :span="4">&nbsp;</el-col>
                                    <el-col :span="8">            
                                        <el-form-item label="修改时间" prop="alter_time">  
                                            <el-date-picker type="date" placeholder="选择日期" @change="alterdateChange" format="yyyy-MM-dd"
                                            value-format="yyyy-MM-dd" v-model="editForm.alter_time" style="width:180px"></el-date-picker>
                                        </el-form-item>
                                    </el-col>
                                </el-row>  
							</el-form>  
					<div slot="footer" class="dialog-footer">  
						<el-button @click.native="editFormVisible = false">取消</el-button>  
						<el-button type="primary" @click.native="editSubmit(editForm)">提交</el-button>  
					</div>  
				</el-dialog> 
					</div>
				</div>
				<!-- main-container -->
			</div>
	</el-container>
</div>

	<!-- /main-box -->
</body>
<script src="../lib/jquery-3.2.1.min.js"></script>
<script src="../lib/vue.min.js"></script>
<script src="../lib/elementUI.js" charset="utf-8"></script>
<script>
	$('#oscar-nav-btn').click(function () {
		$('.dada2').toggle();
	});

	

	var myData = [
		{
			'index': '1',
			'menuName': '首页',
			'url': 'http://www.google.com'
		},
		{
			'index': '2',
			'menuName': '水源管理',
			'url': 'http://www.google.com'
		},
		{
			'index': '3',
			'menuName': '消防力量管理'
		},
		{
			'index': '4',
			'menuName': '重点单位管理',
			'url': '/assets/pages/key-unit.html'
		},
		{
			'index': '5',
			'menuName': '系统管理',
			'children': [
				{ 'index': '2-1', 'menuName': '用户管理', 'url': '/assets/pages/user-list2.html' },
				{ 'index': '2-2', 'menuName': '角色管理', 'url': '/assets/pages/role-list.html' },
				{ 'index': '2-3', 'menuName': '权限管理', 'url': '/assets/pages/permission.html' }
			]
		}
	];
	
	// 定义树节点
	var treeMenuTemplate = [];
	treeMenuTemplate.push('<li class="el-submenu" :class="[open ? \'\': \'\', selected ? \'is-active\':\'\']">');
	treeMenuTemplate.push('<a class="db el-submenu__title" :id="model.index" @click="toggle" v-menu-animation="open" :style="{paddingLeft: paddingLeft + \'px\'}" :href="getUrl">');
	treeMenuTemplate.push('<i class="el-icon-message" v-if="level == 1"></i>');
	treeMenuTemplate.push('<template v-if="hasChildren()">');
	treeMenuTemplate.push('<i class="el-submenu__icon-arrow" :class="[open ? \'el-icon-arrow-up\': \'el-icon-arrow-down\']"></i>');
	treeMenuTemplate.push('</template>');
	treeMenuTemplate.push('{{ model.menuName }}');
	treeMenuTemplate.push('</a>');
	treeMenuTemplate.push('<ul class="el-menu" :class="[open ? \'\' : \'dn\']" v-if="hasChildren()">');
	treeMenuTemplate.push('<tree-menu v-for="item in model.children" :model="item" :level="level + 1" :theId="theId"></tree-menu>');
	treeMenuTemplate.push('</ul>');
	treeMenuTemplate.push('</li>');

	var treeMenu = Vue.component('tree-menu', {
		template: treeMenuTemplate.join(''),

		created: function () {
			var index = this.model.index;
			var hasIndex = this.theId.search(index);
			var lala = index.replace(this.theId, '');
			if (hasIndex == 0) {
				this.open = true;
			}
			if (hasIndex == 0 && lala.length == 0) {
				this.selected = true;
			}
		},

		props: ['model', 'level', 'theId'],

		computed: {
			getUrl: function () {
				if (this.hasChildren()) {
					return "javascript:;";
				}
				return this.model.url;
			}
		},

		data: function () {
			return {
				open: false,
				paddingLeft: this.level * 20,
				selected: false,
				
			};
		},

		methods: {
			hasChildren: function () {
				return this.model.children && this.model.children.length;
			},

			toggle: function () {
				if (this.hasChildren()) {
					this.open = !this.open;
				}
			},
		}

	});

	Vue.directive('menu-animation', function (el, binding) {
		var open = (binding.value);
		var ulElement = $(el).parent().children('ul');
		if (open) {
			ulElement.slideDown(200);
		} else {
			ulElement.slideUp(200);
		}
	});

	// 定义外围树
	var bigTreeTemplate = [];
	bigTreeTemplate.push('<div class="tree-menu">');
	bigTreeTemplate.push('<ul v-for="menuItem in theModel" class="el-menu">');
	bigTreeTemplate.push('<tree-menu :model="menuItem" :level="theLevel" :theId="defaultActive"></tree-menu>');
	bigTreeTemplate.push('</ul>');
	bigTreeTemplate.push('</div>');

	Vue.component('big-tree', {
		template: bigTreeTemplate.join(''),

		props: ['defaultActive'],

		created: function () { },

		data: function () {
			return {
				theModel: myData,
				theLevel: 1
			};
		},

		components: {
			'tree-menu': treeMenu
		}
	});
	new Vue({
		el: '#app',
		data: function() {
		  return { visible: false,
		  awa:"",
		  //搜索表单
		  searchForm: {
			DWMC:"",
			DWDJ:"",
			DWXZ:"",
			XZQY:""
		  },
		  tableData: [
			{
				DWMC:"辽宁省人民法院",
				DWDJ: "省部级",
				DWXZ:"司法",
				XZQY: "辽宁省",
				DWDZ:"霞飞路29号",
				ZDMJ: 5000,
				XFGXJGID: "沈阳市消防局",
				ID:"1"
			},
			   {
				DWMC:"辽宁省政府",
				DWDJ: "省部级",
				DWXZ:"行政",
				XZQY: "辽宁省",
				DWDZ:"霞飞路30号",
				ZDMJ: 50000,
				XFGXJGID: "沈阳市消防局",
				ID:"2"
			},
			{
				DWMC:"辽宁省就业局",
				DWDJ: "省部级",
				DWXZ:"民事",
				XZQY: "辽宁省",
				DWDZ:"霞飞路31号",
				ZDMJ: 20000,
				XFGXJGID: "沈阳市消防局",
				ID:"3"
			},
			{
				DWMC:"沈阳市城市规划管理局",
				DWDJ: "市厅级",
				DWXZ:"城市管理",
				XZQY: "辽宁省",
				DWDZ:"霞飞路32号",
				ZDMJ: 10000,
				XFGXJGID: "沈阳市消防和平分队",
				ID:"4"
			},
			{
				DWMC:"沈阳市公安局",
				DWDJ: "市厅级",
				DWXZ:"司法",
				XZQY: "辽宁省",
				DWDZ:"霞飞路33号",
				ZDMJ: 12000,
				XFGXJGID: "沈阳市消防沈河分队",
				ID:"5"
			},
			{
				DWMC:"沈阳市地铁二号线",
				DWDJ: "市厅级",
				DWXZ:"民事",
				XZQY: "辽宁省",
				DWDZ:"霞飞路34号",
				ZDMJ: 1000,
				XFGXJGID: "沈阳市消防浑南分队",
				ID:"6"
			},
			{
				DWMC:"青岛市塑性加工园",
				DWDJ: "市厅级",
				DWXZ:"城市管理",
				XZQY: "山东省",
				DWDZ:"文明路39号",
				ZDMJ: 2000,
				XFGXJGID: "青岛市市消防大东分队",
				ID:"7"
			},
			{
				DWMC:"泰安市城建局",
				DWDJ: "市厅级",
				DWXZ:"城市管理",
				XZQY: "山东省",
				DWDZ:"法防路36号",
				ZDMJ: 2000,
				XFGXJGID: "泰安市消防塔湾分队",
				ID:"8"
			},
			{
				DWMC:"河北省国土资源厅",
				DWDJ: "省部级",
				DWXZ:"城市管理",
				XZQY: "河北省",
				DWDZ:"格调路46号",
				ZDMJ: 3000,
				XFGXJGID: "河北省消防总队",
				ID:"9"
			},
			{
				DWMC:"秦皇岛市林业局",
				DWDJ: "市厅级",
				DWXZ:"城市管理",
				XZQY: "河北省",
				DWDZ:"发文路64号",
				ZDMJ: 4000,
				XFGXJGID: "秦皇岛市消防大队",
				ID:"10"
			}
		 ],
		   rowdata:'',
		   //表高度变量
		   tableheight :460,
		   //显示加载中样
		   loading: false,
		   labelPosition: 'right',
			//多选值
			multipleSelection: [],
			//当前页
			currentPage: 1,
			//分页大小
			pageSize: 10,
			//总记录数
			total:10, 
			//行数据保存
			rowdata:{

			},
			//序号
			indexData:0,
			//删除的弹出框
			deleteVisible: false,
			//新建页面是否显示
			addFormVisible:false,
			addLoading:false,
			addFormRules:{
				permissionname: [{ required: true, message: "请输入权限名称", trigger: "blur" }]
			},
			//新建数据
			addForm:{
				DWMC:"",
				DWDJ: "",
				DWXZ:"",
				XZQY: "",
				DWDZ:"",
				ZDMJ: "",
				XFGXJGID: ""
			},
			//选中的值显示
			sels: [], 
			//选中的序号
			selectIndex: -1, 
			//编辑界面是否显示
			editFormVisible: false,
			editLoading: false,
			editFormRules: {
				permissionname: [{ required: true, message: "请输入角色名称", trigger: "blur" }]
			},
			//编辑界面数据
			editForm: {
				DWMC:"",
				DWDJ: "",
				DWXZ:"",
				XZQY: "",
				DWDZ:"",
				ZDMJ: "",
				XFGXJGID: ""
			},
		   
		   }
		},
		methods:{
		handleNodeClick(data) {
			console.log(data);
		},
		//表格查询事件
		searchClick: function() {
		var _self = this;
		var tableObject ={};
		var searchData=[];
		var resultData=[];
		//空表不显示
		function isEmptyObject(obj) {
			for (var key in obj) {
				return false;
			}
			return true;
		}
		//起始时间的判断大小的函数
		function tab(begin,end){
			var oDate1 = new Date(begin);
			var oDate2 = new Date(end);
			if(oDate1.getTime() > oDate2.getTime()){
				return true;
			}
			return false;
		}
		//数据还原
		for(var i=0;i<_self.tableData.length;i++){
		var flow=_self.tableData[i];
		searchData.push(flow);
		}       
		for(var i = 0;i<_self.tableData.length;i++){
			if((!(_self.searchForm.DWMC==""&&_self.searchForm.DWDJ==""&&_self.searchForm.DWXZ==""&&_self.searchForm.XZQY==""))&&(_self.searchForm.DWMC!=""?(_self.tableData[i].DWMC == _self.searchForm.DWMC):true)&&(_self.searchForm.DWDJ!=""?(_self.tableData[i].DWDJ == _self.searchForm.DWDJ):true)
			&&(_self.searchForm.DWXZ!=""?(_self.tableData[i].DWXZ == _self.searchForm.DWXZ):true)&&(_self.searchForm.XZQY!=""?(_self.tableData[i].XZQY == _self.searchForm.XZQY):true))
			{	
				var row=_self.tableData[i];
				resultData.push(row);
				
			}
			
		}
		_self.tableData.splice(0,_self.tableData.length);
		if(resultData.length>=1){
			_self.tableData=resultData;
		}
		else{
			_self.tableData.splice(0,_self.tableData.length);
			_self.tableData = searchData;
			}
		_self.total = _self.tableData.length;
		_self.loadingData(); //重新加载数据
		},
		//表格勾选事件
		selectionChange: function(val) {
		 for (var i = 0; i < val.length; i++) {
			 var row = val[i];
		 }
		 this.multipleSelection = val;
		//this.sels = sels
		console.info(val);
		},
		//批量删除数据
		// delGroup() {  
		// 	var ids = this.sels.map(item => item.id).join()//获取所有选中行的id组成的字符串，以逗号分隔
			  
		// },  
		//时间格式
		// dateChange(val) {  
		// 	console.log(val);  
		// 	this.addForm.create_time = val;
		// 	this.editForm.create_time = val;
		// },
		informClick(val){
			window.location.href="inform.html?ID="+val.ID;
		},
		createdateChange(val) {  
			console.log(val);  
			this.addForm.create_time = val;
			this.editForm.create_time = val;
		},
		alterdateChange(val) {  
			console.log(val);  
			this.addForm.alter_time = val;
			this.editForm.alter_time = val;
		},
		begindateChange(val) {  
			console.log(val);  
			this.searchForm.begintime = val;
		},
		enddateChange(val) {  
			console.log(val);  
			this.searchForm.endtime = val;
		},
		//表格重新加载数据
		loadingData: function() {
		var _self = this;
		_self.loading = true;
		setTimeout(function() {
			console.info("加载数据成功");
			_self.loading = false;
		}, 300);
		},
		//表格删除事件
		// deleteClick: function(index,row) {
		// var _self = this;
		// this.$confirm("确认删除" + row.realname + "吗?", "提示", {
		// 	type: "warning",
		// 	confirmButtonText: '确定',
		// 	cancelButtonText: '取消'
		// })
		// 	.then(function() {
		// 	_self.tableData.splice(index,1);
		// 	_self.$message({
		// 		message: row.realname + "删除成功",
		// 		type: "success"
		// 	});
		// 	_self.loadingData(); //重新加载数据
		// 	})
		// 	.catch(function(e) {
		// 	if (e != "cancel") console.log("出现错误：" + e);
		// 	});
		// },

		//新建事件
		addClick: function() {
		var _self = this;
		_self.addFormVisible = true;
		
		},
		//删除所选，批量删除
		removeSelection: function() {
		var _self = this;
		var multipleSelection = this.multipleSelection;
		if (multipleSelection.length < 1) {
			_self.$message({
			message: "请至少选中一条记录",
			type: "error"
			});
			return;
		}
		//var ids = "";
		var ids = [];
		for (var i = 0; i < multipleSelection.length; i++) {
			var row = multipleSelection[i];
			//ids += row.realname + ",";
			ids.push(row.permissionname);
		}
		this.$confirm("确认删除" + ids + "吗?", "提示", {
			type: "warning"
		})
			.then(function() {
			for(var d =0;d< ids.length;d++){
				for(var k=0;k< _self.tableData.length;k++)
					{
						if(_self.tableData[k].permissionname == ids[d]){
							_self.tableData.splice(k,1);
						}
					}
			}
			_self.$message({
				message: ids + "删除成功",
				type: "success"
			});
			_self.total = _self.tableData.length;
			_self.loadingData(); //重新加载数据
			})
			.catch(function(e) {
			if (e != "cancel") console.log("出现错误：" + e);
			});
		},
		//分页大小修改事件
		pageSizeChange: function(val) {
		console.log("每页 " + val + " 条");
		this.pageSize = val;
		var _self = this;
		_self.loadingData(); //重新加载数据
		},
		//当前页修改事件
		currentPageChange: function(val) {
		this.currentPage = val;
		console.log("当前页: " + val);
		var _self = this;
		_self.loadingData(); //重新加载数据
		},
		//表格编辑事件
		editClick: function() {
		var _self = this;
		var multipleSelection = this.multipleSelection;
		if (multipleSelection.length < 1) {
			_self.$message({
			message: "请至少选中一条记录",
			type: "error"
			});
			return;
		}
		else if(multipleSelection.length>1){
			_self.$message({
				message:"只能选一条记录进行编辑",
				type:"error"
			});
			return;
		}
		//var ids = "";
		var ids = [];
		for (var i = 0; i < multipleSelection.length; i++) {
			var row = multipleSelection[i];
			//ids += row.realname + ",";
			ids.push(row.permissionname);
		}
		for(var d =0;d< ids.length;d++){
				for(var k=0;k< _self.tableData.length;k++)
					{
						if(_self.tableData[k].permissionname == ids[d]){
							_self.selectIndex = k;
						}
					}
			}
		this.editForm = Object.assign({}, _self.tableData[_self.selectIndex]);
		//this.editForm.sex=(row.sex == "男"?1:0);
		this.editFormVisible = true;
		},
		//保存点击事件
		editSubmit: function(val) {
		var _self = this;
		this.tableData[this.selectIndex].permissionname = val.permissionname;
		this.tableData[this.selectIndex].permissioninfo = val.permissioninfo;
		this.tableData[this.selectIndex].create_name = val.create_name;
		this.tableData[this.selectIndex].create_time = val.create_time;
		this.tableData[this.selectIndex].alter_name = val.alter_name;
		this.tableData[this.selectIndex].alter_time = val.alter_time;
		this.editFormVisible = false;
		_self.loadingData();//重新加载数据
		console.info(this.editForm);
		},
		//新建提交点击事件
		addSubmit: function(val) {
			var _self=this;
			this.tableData.unshift({
				permissionname: val.permissionname,
				permissioninfo: val.permissioninfo,
				create_name:val.create_name,
				create_time:val.create_time,
				alter_name:val.alter_name,
				alter_time:val.alter_time
			});
			this.addFormVisible = false;
			_self.total = _self.tableData.length;
			_self.loadingData();//重新加载数据
			val.permissionname = "";
			val.permissioninfo = "";
			val.create_name = "";
			val.create_time ="";
			val.alter_name = "";
			val.alter_time ="";
			console.info(this.addForm);
			
		},
		closeDialog:function(val){
			this.addFormVisible = false;
			val.permissionname = "";
			val.permissioninfo = "";
			val.create_name = "";
			val.create_time ="";
			val.alter_name = "";
			val.alter_time ="";
		}
	},
		
})
	  
	  $('#menu-toggle-btn').click(function () {
		var left = $('.left-sidebar'),
			main = $('.main-box'),
			$this = $(this);
		if (left.hasClass('damin')) {
			left.removeClass('damin').css('left', '0');
			main.css('padding-left', '240px');
			setTimeout(function () {
				$this.removeClass('menu-toggle-bg').css({ "right": "0", "transform": "rotateY(0)" });
			}, 300);
		} else {
			left.addClass('damin').css('left', '-240px');
			main.css('padding-left', 0);
			setTimeout(function () {
				$this.addClass('menu-toggle-bg').css({ "right": "-26px", "transform": "rotateY(180deg)" });
			}, 300);
		}
	});
</script>
</html>